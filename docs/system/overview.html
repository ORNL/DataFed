

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>System Overview &mdash; DataFed 1.4 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Use Cases" href="usecases.html" />
    <link rel="prev" title="Introduction" href="introduction.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> DataFed
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">About DataFed</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">System Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#cross-facility-data-management">Cross-Facility Data Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="#system-architecture">System Architecture</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#interfaces">Interfaces</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#user-accounts">User Accounts</a></li>
<li class="toctree-l2"><a class="reference internal" href="#system-concepts">System Concepts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#quick-reference">Quick Reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="#identifiers-and-aliases">Identifiers and Aliases</a></li>
<li class="toctree-l3"><a class="reference internal" href="#data-records">Data Records</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#metadata">Metadata</a></li>
<li class="toctree-l4"><a class="reference internal" href="#provenance">Provenance</a></li>
<li class="toctree-l4"><a class="reference internal" href="#raw-data">Raw Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="#field-summary">Field Summary</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#collections">Collections</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#root-collection">Root Collection</a></li>
<li class="toctree-l4"><a class="reference internal" href="#public-collections">Public Collections</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id1">Field Summary</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#projects">Projects</a></li>
<li class="toctree-l3"><a class="reference internal" href="#access-controls">Access Controls</a></li>
<li class="toctree-l3"><a class="reference internal" href="#repository-allocations">Repository Allocations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#catalog">Catalog</a></li>
<li class="toctree-l3"><a class="reference internal" href="#data-search">Data Search</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="usecases.html">Use Cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="papers.html">Papers and Presentations</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
</ul>
<p class="caption"><span class="caption-text">Web Portal</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user/web/portal.html">Web Portal Guide</a></li>
</ul>
<p class="caption"><span class="caption-text">Client Package</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user/client/install.html">Installation and Configuration</a></li>
</ul>
<p class="caption"><span class="caption-text">Command Line Interface</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user/cli/guide.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/cli/reference.html">Command Reference</a></li>
</ul>
<p class="caption"><span class="caption-text">Python Interface</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user/python/high_level_guide.html">Guide to High Level Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/python/notebooks.html">Jupyter Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../autoapi/index.html">API Reference</a></li>
</ul>
<p class="caption"><span class="caption-text">Administration</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../admin/general.html">Administration</a></li>
</ul>
<p class="caption"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dev/project.html">Project Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev/design.html">Architecture &amp; Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev/roadmap.html">Feature Road Map</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">DataFed</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>System Overview</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="system-overview">
<h1>System Overview</h1>
<p>DataFed is a scientific data federation formed from a network of distributed services and data storage
repositories that enable users to create, locate, share, and access working scientific data from any
organization, facility, or workstation within the DataFed network. DataFed provides a software framework
for the federation of distributed raw data storage resources along with centralized metadata indexing,
data discovery, and collaboration services that combine to form a virtual “data backplane” connecting
otherwise disjoint systems into a uniform data environment. Conceptually, DataFed is a modern and domain-
agnostic “data grid” application with a host of advanced data management and collaboration features
aimed at the open science and HPC communities.</p>
<p>DataFed features a robust and scalable centralized data indexing and orchestration service that ties
potentially large numbers of independent DataFed data storage repositories together with high-performance
data transfer protocols and federated identity technologies. This approach prevents the formation of
independent “data silos” that suppress data discovery and access from outside of specific host organizations
or domains - yet this architecture is scalable since data storage and transfer loading is distributed across
many independently managed data repositories. Currently, DataFed’s central services are hosted within the
Oak Ridge Leadership Computing Facility (OLCF) at the Department of Energy’s Oak Ridge National Laboratory
(ORNL).</p>
<p>DataFed presents managed data using a <em>logical</em> view (similar to a database) rather than a direct physical
view of files in directories on a particular file system. Data that is managed by a DataFed repository is
maintained in system-controlled storage with no user-level file system access. This is to both protect the
managed data from inadvertent changes or deletions, and to ensure that all data read/write operations go
through a DataFed interface for proper system-wide coordination and access control. This approach is a step
towards unifying and simplifying data discovery, access, and sharing - as well as avoiding the inherent
entropy of traditional file systems that can lead to data misidentification, mishandling, and an eventual
loss of scientific reproducibility.</p>
<div class="section" id="cross-facility-data-management">
<h2>Cross-Facility Data Management</h2>
<p>Figure 1, below, shows a simplified representation of an example DataFed network consisting of the central
DataFed services and several connected facilities and DataFed repositories. The enclosing gray boxes
represent the physical boundaries of geographically distributed facilities. The wide blue arrows represent
the DataFed high-speed raw data transfer “bus” (i.e. GridFTP) that is used to move data between facilities,
and the green arrows represent the DataFed communication “bus” use by clients to send requests to DataFed.</p>
<div class="figure align-center" id="id2">
<img alt="../_images/simplified_architecture.png" src="../_images/simplified_architecture.png" />
<p class="caption"><span class="caption-text">Figure 1 - An Example DataFed Network</span></p>
</div>
<p>In this example, there is an observational facility and a compute facility that each have a local DataFed
data repository (a cylinder labeled with an ‘R’). Any facility in the system can read or write data from or to
the data repositories in the observational or compute facilities (assuming proper access permissions); however,
users within these two facilities will have lower latency access to the data stored there. In addition,
independent workstations can also access data in these repositories - also assuming proper access permissions
are granted.</p>
<p>When data is stored to a DataFed repository, Globus is used to transfer a user-specified source file (as a Globus
path) into the repository where it becomes associated with a DataFed data record. Likewise, when data is retrieved
from a DataFed repository, Globus is used to transfer the raw data of a DataFed record from the repository to a user-
specified Globus destination; however, note that the raw data is simply copied - not moved - from the DataFed
repository. The central DataFed service maintains data record tracking information and orchestrates raw data
transfers, but never directly processes raw data.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>DataFed provides a universal storage allocation and fine-grained access control mechanisms to
enable users at disjoint organizations to share and access data with each other without undue burden on
local system administrators. Local administrators are able to maintain and enforce data policies
on local DataFed repositories without disrupting remote DataFed facilities or users in any way.</p>
</div>
<p>Continuing with the previous example, the experimental facility shown does not have a local DataFed repository
and, instead, could use allocations on the DataFed repository within the compute facility (if, for example, these
facilities were collaborating or were managed by the same organization). In this scenario, users at the experimental
facility would store and retrieve data using a DataFed allocation granted by the compute facility, but from the users
perspective, all DataFed interactions would behave as if the repository were local. The only noticeable
difference would be increased latency associated with DataFed data transfers.</p>
<p>Many cross-facility and collaborative research scenarios are supported by DataFed, and specific examples are discussed
in the DataFed <a class="reference internal" href="usecases.html"><span class="doc">Use Cases</span></a> document.</p>
</div>
<div class="section" id="system-architecture">
<h2>System Architecture</h2>
<p>The DataFed system is composed of a number of system components and interfaces that are deployed across
the DataFed network to implement scalable distributed data storage and indexing. A simplified system architecture
is shown in Figure 2, below, and shows only the central DataFed services, one DataFed data repository, and
supporting interfaces.</p>
<div class="figure align-center" id="id3">
<a class="reference internal image-reference" href="../_images/system_components.png"><img alt="../_images/system_components.png" src="../_images/system_components.png" style="width: 570.75px; height: 433.5px;" /></a>
<p class="caption"><span class="caption-text">Figure 2 - DataFed System Components</span></p>
</div>
<p>DataFed’s central services include the “Core” service which is essentially the “brains” of DataFed. The core
service manages the metadata associated with managed raw data and also implements access control, orchestration,
and concurrency controls for data movements across the DataFed network. The core service, however, is not directly
involved in the transfer of raw data - this function is delegated to Globus services, or more specifically, to the
GridFTP servers (managed by GLobus) located at DataFed data repositories and other facilities. (The blue lines in
Figure 2 indicate high-performance raw data transfer pathways.)</p>
<p>The raw data storage resources within a DataFed data repository can be any form of physical storage hardware, so long
as the interface to this storage is supported by Globus. Currently this includes POSIX file systems and S3 object
stores. The inherit reliability of the physical storage of a repository is determined by the host facility and
could range from inexpensive magnetic disks to high-speed solid state drives or even archival-quality geographically
distribute storage systems. Local administrators control repository policies and determine which DataFed users can
utilize a repository by granting (or revoking) repository allocations. These local administrative policies and actions
have impact on DataFed on repositories at other facilities.</p>
<p>Figure 2 shows a DataFed repository in isolation; however, a host facility would typically integrate their DataFed
repositories with their own local storage and compute resources. For example, a facility would likely have additional
Globus endpoints that would mount the primary file system(s) of the facility, and they would install high-speed
interconnects between the DataFed repository endpoint and the facility endpoint(s) to increase data transfer speeds
between the two storage systems.</p>
<p>The web services within the DataFed central services primarily support a web portal that allows users to easily organize
and share data from a web browser; however, the web services also play a critical role in authenticating DataFed users
through Globus’ federated identity system (which is based on OAuth2). New DataFed users must register through the
DataFed data portal and grant certain permission to DataFed through Globus’ authorization system. These permissions
relate to user identification and enabling automatic data transfers on behalf of DataFed users.</p>
<div class="section" id="interfaces">
<h3>Interfaces</h3>
<p>Users are able to interact with DataFed through several available interfaces including a graphical web application,
a command-line interface (CLI), and both high- and low-level application programming interfaces (APIs). The easiest
way to interact with DataFed is through the web application (see <a class="reference internal" href="../user/web/portal.html"><span class="doc">DataFed Web Portal</span></a>), and
the web application is where users initially register for DataFed accounts.</p>
<p>The DataFed CLI and APIs are all provided through a single Python-based DataFed client packaged available on PyPi. Refer
to the <a class="reference internal" href="../user/client/install.html"><span class="doc">Client Installation</span></a>, <a class="reference internal" href="../user/cli/guide.html"><span class="doc">CLI User Guide</span></a>, and
<a class="reference internal" href="../user/python/high_level_guide.html"><span class="doc">Python Scripting Guide</span></a> for more information.</p>
<p>DataFed’s interfaces can be used from any workstation, laptop, or compute node; however, these interfaces only provide
users with the ability to issue commands to the DataFed central service. If users need to be able to also transfer raw
data to or from a given host machine, the local file system of the host machine must be connected to a Globus endpoint.
Typically, research facilities will already provide Globus endpoints to access specific local file systems; however, for
individual workstations and laptops, users will need to install Globus Personal Connect. See <cite>DataFed Client Installation &lt;/user/client/install&gt;</cite>
for more information.</p>
</div>
</div>
<div class="section" id="user-accounts">
<h2>User Accounts</h2>
<p>User must register with DataFed in order to access public or shared data records and collections; however, registration
is free and only requires a Globus account. (Refer to the <cite>/system/getting_started</cite> document for help with the
registration process.) Once registered, users are tracked internally by their Globus identity but can also be searched for
using their proper names. In order for users to be able to create their own data records, an allocation on one or more DataFed
data repositories is required. Please contact the IT department at a DataFed-enabled facility for assistance with
acquiring a DataFed repository allocation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In a future release of DataFed, a searchable directory of available data repositories will be made available and allow
users to request allocations directly from within DataFed.</p>
</div>
<p>DataFed registration utilizes a standard Globus authentication and authorization process. When you begine the registration
process from the DataFed welcome page, you will be redirected to Globus for authentication (log-in) using your Globus account.
Globus will then ask you to authorize DataFed to access your Globus identity and to allow DataFed to transfer data on your behalf.
Once this process is complete, you will be redirected to a DataFed post-registration page where you will create a DataFed password.
This password is only used when manually authenticating from the DataFed command-line interface, and it can be updated from
DataFed Web Portal at any time.</p>
<p>Note that DataFed will only initiate data transfers when you (or a process running as you) explicitly request it to. Further,
DataFed data transfers are constrained to be between DataFed data storage repositories and Globus endpoints that you have pre-authorized
(or “activated”) for access. Globus end-point activation is transient and access will expire within a period determined by the
policies of the host facility.</p>
</div>
<div class="section" id="system-concepts">
<h2>System Concepts</h2>
<p>DataFed provides a uniform, holistic, and logical view of the data, users, and various organizational structures associated
with the federation of facilities and data storage resources that make up the DataFed network. From a users perspective,
all data operations look and feel the same from within DataFed regardless of where DataFed is being accessed, where data is
physically stored, or which DataFed interface is being utilized. In order to understand the features and capabilities of
DataFed, as a whole, it is necessary to understand the underlying terminology and concepts, and these are discussed in this
section.</p>
<p>Because DataFed relies heavily upon Globus for data transfers, it is helpful to understand the basics of how Globus works and
how to use it to move data between Globus endpoints. A good starting point for understanding Globus can be found <a class="reference external" href="https://www.globus.org/data-transfer">here</a>.</p>
<div class="section" id="quick-reference">
<h3>Quick Reference</h3>
<p>Below is a brief, alphabetical list of the most common DataFed terms and concepts. These topics are discussed in
greater detail in following sections of this document.</p>
<ul class="simple">
<li><p><strong>Access Control</strong> - Access controls are sets of fine-grained permissions associated with data records and/or collections that may be
applied to specific users or groups of users.</p></li>
<li><p><strong>Administrator</strong> - A user designated by DOE/ORNL to have full access to DataFed administrative functions.</p></li>
<li><p><strong>Aliases</strong> - An alias is an optional, human-friendly alternate identifier for data records and collections.</p></li>
<li><p><strong>Allocation</strong> - An allocation is a storage allowance on a specific DataFed repository. One or more allocations are required
in order to create DataFed data records.</p></li>
<li><p><strong>Annotation</strong> - Annotations are a mechanism for opening and tracking issues associated with data records and collections. Depending on
the severity and outcome of an issue, DataFed may propagate issues to downstream data records for further impact assessment.</p></li>
<li><p><strong>Attributes</strong> - Attributes are searchable system-defined (fixed) metadata fields associated with certain entities (data records, collections,
etc.) within DataFed. Textual attributes of data records and collections (ie. title, description) are full-text indexed. The term
“attributes” is used to avoid confusion with optional user-defined “metadata”.</p></li>
<li><p><strong>Catalog</strong> - The DataFed catalog is a categorized searchable index of internally “published” DataFed collections. All included
collections and contained data records are readable by any DataFed user. The catalog system is intended for sharing working, rather than static, datasets.</p></li>
<li><p><strong>Collection</strong> - A collection is a logical (or virtual) folder with a unique identifier and attributes that can be used to
hierarchically organize, share, and download groups of data records and/or other collections.</p></li>
<li><p><strong>Creator</strong> - The user that originally creates a Data Record becomes the owner (and creator) of the record and has full irrevocable access to the given record.</p></li>
<li><p><strong>Data Record</strong> - A data record is the most basic unit of data within DataFed and consists of a unique identifier, attributes,
and, optionally, raw data and domain-specific metadata.</p></li>
<li><p><strong>Group</strong> - A group is a user-defined set of users for applying access controls to data records or collections. Groups are not the same as projects.</p></li>
<li><p><strong>Identifier</strong> - Identifiers are system-unique alphanumeric strings that are automatically assigned to all entities within DataFed.</p></li>
<li><p><strong>Metadata</strong> - The term “metadata” refers to optional searchable user-defined (domain-specific) structured metadata associated with data
records. Required top-level metadata is referred to as “attributes” to avoid confusion.</p></li>
<li><p><strong>Owner</strong> - The user or project that originally creates a Data Record becomes the owner of the record and has full access
to the given record. Ownership can be transferred to another user or project.</p></li>
<li><p><strong>Project</strong> - A DataFed project is a logical grouping of users to enable collective ownership of data and to simplify collaboration.
Projects have their own data storage allocations.</p></li>
<li><p><strong>Project Administrator</strong> - A user designated by a Project Owner to have managerial access to a specified project.</p></li>
<li><p><strong>Project Owner</strong> - Any user that creates a DataFed Project is the owner, with full access rights, of the project.</p></li>
<li><p><strong>Project Member</strong> - A user designated by either a Project Owner or Administrator to have member access to a specified project.</p></li>
<li><p><strong>Provenance</strong> - Provenance is a form of metadata associated with data records that captures relationships with other data records.
Provenance is maintained by DataFed using direct links between records rather than identifier references in record attributes or metadata.</p></li>
<li><p><strong>Repository</strong> - A repository is a federated storage system located at a specific facility that stores the raw data associated with DataFed
data records. Users and projects may be granted allocations on repositories to enable data storage.</p></li>
<li><p><strong>Repository Administrator</strong> - A user designated by a DataFed Administrator to have managerial access to a data repository.</p></li>
<li><p><strong>Root Collection</strong> - The root collection is a reserved collection that acts as the parent for all other (top-level) collections
and data records. Each user and project has their own root collection.</p></li>
<li><p><strong>Saved Query</strong> - A saved query is a data search expression that is stored in a query object such that it can be subsequently
run by referencing the associated query identifier. The results of saved queries are dynamic (i.e. matches from when the query
is run, rather than when it was saved).</p></li>
<li><p><strong>Shared Data</strong> - When a user grants permission to access data records and/or collections to other users, those records and collections
become visible to the referred users as “shared data”.</p></li>
<li><p><strong>Tags</strong> - Tags are searchable, user-defined words that may be associated with data records and collections. Tags use is tallied internally
to allow popular tags to be identified by users.</p></li>
<li><p><strong>Task</strong> - Tasks are trackable background processes that run on the DataFed server for specific longer-running operations such as data
transfers and allocation changes.</p></li>
<li><p><strong>User</strong> - Any person with a DataFed account. Users are identified by their unique Globus ID account name, with optionally linked organizational accounts.</p></li>
</ul>
</div>
<div class="section" id="identifiers-and-aliases">
<h3>Identifiers and Aliases</h3>
<p>All system “entities” in DataFed (data, collections, user, projects, etc.) are automatically assigned system-unique identifiers (IDs)
consisting of a prefix (that determines entity type) followed by an alphanumeric value. For example, “d/12345678” would be
an ID for data record, and “c/87654321” would be a collection. The numeric portion of these IDs is not in any particular order
and can be considered essentially random, but unique for a given entity type. System IDs are not easy for humans to remember and
use, thus for data records and collections (which are referenced frequently) users may opt to assign a human-friendly “alias”
that can be used in place of the system identifier.</p>
<p>Aliases are lowercase alphanumeric strings that can contain the letters ‘a’ through ‘z’, the numbers ‘0’ through ‘9’, and the
special characters ‘-‘,’_’, and ‘.’. Aliases can be considered to be the equivalent of a file or directory name in a file
system. A scoping prefix is automatically attached to aliases in order to ensure aliases are unique across all users
(and projects) in DataFed. These prefixes consist of the type of the alias owner (“u” for users, and “p” for projects),
followed by the user or project ID, separated by colons. For example:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>The alias &quot;my.data&quot; for user &quot;u/user123&quot; becomes &quot;u:user123:my.data&quot;

and

The alias &quot;simulation.run.1&quot; within project &quot;p/stf123&quot; becomes &quot;p:stf123:simulation.run.1&quot;
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In both the DataFeb web portal and the command-line interface, scoping prefixes are not required to be entered for aliases
(nor are they displayed) except when referencing data owned by another user or project.</p>
</div>
<p>In general, aliases are intended to support interactive data browsing and sharing and, thus, should be easy to use and understand.
Aliases should <em>not</em> be used to encode complex parameters or other information that is more appropriately placed in a data record’s
searchable metadata. This is especially true when sharing data with users that may not be familiar with an ad hoc name-based parameter
encoding scheme.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Capturing and storing scientific parameters and other context as searchable, schema-based metadata results in data that
is far more <em>findable</em> and <em>interoperable</em> than encoding this information in aliases.</p>
</div>
</div>
<div class="section" id="data-records">
<h3>Data Records</h3>
<p>A data record is the basic unit of data storage within DataFed and consist of, at a minimum, an identifier and a title. A number
of additional optional informational fields can be specified including an alias, a textual description, structured metadata,
provenance relationships, and tags. All of these data record fields are maintained centrally within DataFed and do not count
against a users storage allocation(s). Refer to the <span class="xref std std-ref">Field Summary</span>, below, for a full list of data record fields.</p>
<p>While metadata-only data records can be useful for specific use cases, it is likely some form of source data will need to be
associated with a given data record. This data is referred to as “raw data” because DataFed treats it as an oblique attachment to a
data record (i.e. DataFed cannot “see” inside this raw data for purposes of indexing or searching). Raw data can be any format
and any size so long as a user has sufficient allocation space to store it. See the <span class="xref std std-ref">Raw Data</span> section, below, for further details.</p>
<p>When creating a data record, a storage allocation on a DataFed repository must be available. If a user has multiple allocations,
then an allocation can be specified or the default allocation will be used instead. The default allocation can be viewed and set
in the DataFed web portal. After creation, it is possible to move a record to an allocation on a different repository, and if raw
data has been uploaded it will be relocated automatically. Similarly, data record ownership can be transferred to another DataFed
user or project, and again, raw data will be relocated.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If large collections of data records are moved between allocations, or to new owners, the server-side background task associated
with moving the raw data may take a significant amount of time to complete. Progress can be monitored via the web portal or the CLI.</p>
</div>
<div class="section" id="metadata">
<h4>Metadata</h4>
<p>The metadata of a data record is distinct from the built-in record fields such as title and description,
and is represented using Javascript Object Notation (JSON). JSON was selected because it is human-readable, can represent
arbitrary structured documents, and is easily validated using JSON-based schemas (see <a class="reference external" href="https://json-schema.org/">https://json-schema.org/</a>). Like
other fields, metadata is searchable using the powerful built-in query language described in the <span class="xref std std-ref">Data Search</span> section of
this document.</p>
<p>When creating or updating a data record, metadata may be directly specified or a JSON file may be referenced as the metadata source.
When updating the metadata associated with an existing data record, the user has the option to either replace all of the existing
metadata or to merge new metadata with existing metadata. In the case of merging, any keys that are present both the new and
existing metadata will be overwritten by the new values - other existing keys are left unchanged and new keys are inserted.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When providing metadata, it must fully comply with the JSON specification, located at <a class="reference external" href="https://tools.ietf.org/html/rfc8259">https://tools.ietf.org/html/rfc8259</a>.</p>
</div>
</div>
<div class="section" id="provenance">
<h4>Provenance</h4>
<p>Provenance information in DataFed is maintained as direct links between any two data records, and includes a direction
and a type. Currently three types of provenance relationships are supported, as shown in the table below. The direction of
provenance relationships is implicitly defined by setting relationship information on “dependent” data records only.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 100%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Relationship</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Is Derived From</p></td>
</tr>
<tr class="row-odd"><td><p>Is a Component Of</p></td>
</tr>
<tr class="row-even"><td><p>Is a Newer Version Of</p></td>
</tr>
</tbody>
</table>
<p>It is easy to understand provenance direction by thinking of the dependent record as the subject of the relationship statement.
For example, if data record “xyz” “is derived from” data record “pqr”, then data record “xyz” is the dependent and the provenance
relationship to record “pqr” should be set on record “xyz”.</p>
</div>
<div class="section" id="raw-data">
<h4>Raw Data</h4>
<p>Raw data is associated with a DataFed data record by uploading a source file from a Globus endpoint, and, once uploaded, it
can be downloaded to any other Globus endpoint. Users uploading and/or downloading raw data must have appropriate
permissions both on the source/destination Globus endpoints and on the DataFed record itself. When data is uploaded to a
data record, the source path, extension, and data size is captured in the data record. When downloading, users can request
either the original filename or the record identifier be used as the name for the downloaded file.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As with all Globus transfers, it is the users responsibility to ensure that the source or destination endpoints are activated
prior to initiating a raw data transfer in DataFed. This restriction is due to the inherent security design of Globus, which
prohibits agent processes, like DataFed, from activating endpoints on behalf of users. Note, however, that DataFed data
repositories never require activation.</p>
</div>
<p>When a raw data transfer is initiated from DataFed, the transfer can be monitored in DataFed using the “Task ID” of the transfer
request. In the DataFed CLI and Python API, the task ID is provided in the output of the request. In the DataFed web portal,
the most recent tasks will be shown and periodically updated under the “Tasks” tab. When a transfer completes without errors,
the task status will become “SUCCESS”; otherwise an error message will be provided. Common problems include forgetting to
activate an endpoint, endpoint activation expiring, or referencing an invalid path or filename.</p>
</div>
<div class="section" id="field-summary">
<h4>Field Summary</h4>
<p>The table below lists all of the fields of a data record. Most of these fields are searchable using simple
equality tests (i.e. == and !=); however the title and description fields are full-text indexed - enabling root-word and phrase
searches as well. When composing search expressions, the field names as shown in the third column of the table must be used.
User-specified metadata fields can be searched by prefixing the field names in the associated JSON document with “md.”.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 58%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Field</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ID</p></td>
<td><p>Auto</p></td>
<td><p>id</p></td>
<td><p>Auto-assigned system-unique identifier</p></td>
</tr>
<tr class="row-odd"><td><p>Alias</p></td>
<td><p>Optional</p></td>
<td><p>alias</p></td>
<td><p>Human-friendly alternative identifier</p></td>
</tr>
<tr class="row-even"><td><p>Title</p></td>
<td><p>Required</p></td>
<td><p>title</p></td>
<td><p>Title of record</p></td>
</tr>
<tr class="row-odd"><td><p>Description</p></td>
<td><p>Optional</p></td>
<td><p>desc</p></td>
<td><p>Description of record (markdown allowed)</p></td>
</tr>
<tr class="row-even"><td><p>Tags</p></td>
<td><p>Optional</p></td>
<td><p>—</p></td>
<td><p>Tag list</p></td>
</tr>
<tr class="row-odd"><td><p>Metadata</p></td>
<td><p>Optional</p></td>
<td><p>md.*</p></td>
<td><p>User-specified JSON document</p></td>
</tr>
<tr class="row-even"><td><p>Provenance</p></td>
<td><p>Optional</p></td>
<td><p>—</p></td>
<td><p>Relationship(s) with other data records</p></td>
</tr>
<tr class="row-odd"><td><p>Allocation</p></td>
<td><p>Default</p></td>
<td><p>—</p></td>
<td><p>Data repository ID of allocation used</p></td>
</tr>
<tr class="row-even"><td><p>Owner</p></td>
<td><p>Auto</p></td>
<td><p>owner</p></td>
<td><p>User ID of current record owner</p></td>
</tr>
<tr class="row-odd"><td><p>Creator</p></td>
<td><p>Auto</p></td>
<td><p>creator</p></td>
<td><p>User ID of original record creator</p></td>
</tr>
<tr class="row-even"><td><p>Source</p></td>
<td><p>Auto</p></td>
<td><p>source</p></td>
<td><p>Globus path of source raw data</p></td>
</tr>
<tr class="row-odd"><td><p>Size</p></td>
<td><p>Auto</p></td>
<td><p>size</p></td>
<td><p>Size of raw data, in bytes</p></td>
</tr>
<tr class="row-even"><td><p>Ext</p></td>
<td><p>Optional</p></td>
<td><p>ext</p></td>
<td><p>Extension of raw data file</p></td>
</tr>
<tr class="row-odd"><td><p>Create Time</p></td>
<td><p>Auto</p></td>
<td><p>ct</p></td>
<td><p>Creation timestamp (Unix)</p></td>
</tr>
<tr class="row-even"><td><p>Update Time</p></td>
<td><p>Auto</p></td>
<td><p>ut</p></td>
<td><p>Update timestamp (Unix)</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="collections">
<h3>Collections</h3>
<p>Collections in DataFed are a logical mechanism for organizing, sharing, and downloading sets of data records. Data records
may be placed in multiple collections (as links) and child collections may be created to further organize contained
records. Like data records, collections have, at a minimum, an identifier and a title, but additional optional fields may
be defined including an alias, a description, public access, and tags. Unlike data records, collections do not support
user-specified structured metadata.</p>
<p>Collections do not exclusively “own” the data records contained within them, but certain collection operations will directly
impact the records (and child collections) within them. There are also constraints on which data records can be placed in a
collection. These operations and constraints are as follows:</p>
<ul class="simple">
<li><p><strong>Permissions</strong> - Collections allow inheritable permissions to be set that apply to all contained data records and child
collections. This is generally the preferred way to share data other users and to control data access within a project.</p></li>
<li><p><strong>Single Owner</strong> - It is not currently possible to mix data records owned by multiple users in a single collection. Only data
records owned by the user that also owns the collection can be linked (this applies to project collections as well). However, this
restriction does not apply to record “creators”.</p></li>
<li><p><strong>Deletion</strong> - If a collection is deleted, all child collections, as well as all data records that exist <em>only</em> within the deleted
collection hierarchy, will be deleted.</p></li>
<li><p><strong>Downloads</strong> - Downloading a collection will download all raw data associated with contained data records - including those in
child collections. Downloaded raw data will all be placed in the same user-specified destination path (without subdirectories).
The DataFed web portal will display download dialog with a selectable list of which data records to download
from the collection.</p></li>
<li><p><strong>Allocation Change</strong> - Collections can be used to change the repository allocations of all contained data records. Any
contained data record that is not already on a specified target allocation will be scheduled to be moved. Those that are already
on the target allocation will be ignored. Currently, this operation can only be done in the DataFed web portal.</p></li>
<li><p><strong>Ownership Change</strong> - Collections can be used to change the ownership of contained data records. All records are moved to
a specified target collection owned by the new owner, and the all associated raw data will be scheduled to be moved to the new
owner’s default allocation. Currently, this operation can only be done in the DataFed web portal.</p></li>
</ul>
<div class="section" id="root-collection">
<h4>Root Collection</h4>
<p>All users and projects own a special “root” collection that acts as the parent for all other (top-level) collections and/or
data records. The root collections behaves like a normal collection except that it cannot be edited or deleted. The root
collection also has a special identifier and alias which are derived from the type and owner identifier, as follows:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>For a user with an ID of &quot;user123&quot;, the root collection ID is &quot;c/u_user123_root&quot; and the alias is &quot;u:user123:root&quot;

For a project with an ID of &quot;proj123&quot;, the root collection ID is &quot;c/p_proj123_root&quot; and the alias is &quot;p:proj123:root&quot;
</pre></div>
</div>
</div>
<div class="section" id="public-collections">
<h4>Public Collections</h4>
<p>Collections can be set to public access, in which case the collection and all of its contents will become discoverable and
readable by any DataFed user. Public access is implemented through a DataFed catalog system which allows users to browse
and search for public collections and datasets. Please refer to the <span class="xref std std-ref">Catalog</span> section for more information.</p>
</div>
<div class="section" id="id1">
<h4>Field Summary</h4>
<p>The table below lists all of the fields of a collection. Currently, only public collections in the DataFed catalog can be
searched, and only through the DataFed web portal. In a future release, direct queries will be supported.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 58%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Field</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ID</p></td>
<td><p>Auto</p></td>
<td><p>id</p></td>
<td><p>Auto-assigned system-unique identifier</p></td>
</tr>
<tr class="row-odd"><td><p>Alias</p></td>
<td><p>Optional</p></td>
<td><p>alias</p></td>
<td><p>Human-friendly alternative identifier</p></td>
</tr>
<tr class="row-even"><td><p>Title</p></td>
<td><p>Required</p></td>
<td><p>title</p></td>
<td><p>Title of record</p></td>
</tr>
<tr class="row-odd"><td><p>Description</p></td>
<td><p>Optional</p></td>
<td><p>desc</p></td>
<td><p>Description of record (markdown allowed)</p></td>
</tr>
<tr class="row-even"><td><p>Tags</p></td>
<td><p>Optional</p></td>
<td><p>—</p></td>
<td><p>Tag list</p></td>
</tr>
<tr class="row-odd"><td><p>Access</p></td>
<td><p>Default</p></td>
<td><p>—</p></td>
<td><p>Public or private (default) access</p></td>
</tr>
<tr class="row-even"><td><p>Category</p></td>
<td><p>Optional</p></td>
<td><p>—</p></td>
<td><p>Catalog category for public access</p></td>
</tr>
<tr class="row-odd"><td><p>Owner</p></td>
<td><p>Auto</p></td>
<td><p>owner</p></td>
<td><p>User ID of current collection owner</p></td>
</tr>
<tr class="row-even"><td><p>Creator</p></td>
<td><p>Auto</p></td>
<td><p>creator</p></td>
<td><p>User ID of original collection creator</p></td>
</tr>
<tr class="row-odd"><td><p>Create Time</p></td>
<td><p>Auto</p></td>
<td><p>ct</p></td>
<td><p>Creation timestamp (Unix)</p></td>
</tr>
<tr class="row-even"><td><p>Update Time</p></td>
<td><p>Auto</p></td>
<td><p>ut</p></td>
<td><p>Update timestamp (Unix)</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="projects">
<h3>Projects</h3>
<p>A DataFed project is a distinct organizational unit that permits multiple users to create and manage data records and
collections as a team - without requiring project members to maintain their own complex access control rules. Projects
can be created by any DataFed user, but a DataFed repository allocation is required for the project before any data
records can be created within, or transferred to, the project. Projects have specific user roles with distinct
permissions, as follows:</p>
<ul class="simple">
<li><p><strong>Project Owner</strong> - The user that initially creates a project becomes the owner and has complete control over the
project and contained data and collections. The owner can add and remove project members and administrators.</p></li>
<li><p><strong>Administrators</strong> - These users have the ability to add and remove project members (but not other administrators), and
can also configure access control rules on the projects root collection.</p></li>
<li><p><strong>Members</strong> - These users may create and update data records and collections based on the access control rules set by
the project owner or administrators. Members always have administrative access to records they create.</p></li>
</ul>
<p>When any user associated with a project creates a data record or collection inside a project, the project, rather than
the creating user, becomes the owner of the new record or collection. While users still have administrative control over
records and collections they create within a project, the allocation of the project is used to store and manage any raw
data associated with these records.</p>
</div>
<div class="section" id="access-controls">
<h3>Access Controls</h3>
<p>DataFed implements fine-grained access control through a set of permissions that can be applied to both data records and
collections. Permissions can be configured to apply to specific users, groups of users, or a combination of
these, and define what specific actions users can take. Collections also allow specification of inherited permissions that
are applied to items linked within it. The individual permissions are as follows:</p>
<ul class="simple">
<li><p>READ REC - Allows reading basic information about a data record or collection.</p></li>
<li><p>READ META - Allows reading structured metadata of a data record.</p></li>
<li><p>READ DATA - Allows downloading raw data from a data record.</p></li>
<li><p>WRITE REC - Allows updating basic information of a data record or collection.</p></li>
<li><p>WRITE META - Allows updating structured metadata of a data record.</p></li>
<li><p>WRITE DATA - Allows uploading raw data to a data record.</p></li>
<li><p>LIST - Allows listing of items linked within a collection (does not imply reading these items)</p></li>
<li><p>LINK - Allows linking an unlinking items to/from a collection</p></li>
<li><p>CREATE - Allows new items to be created within a collection</p></li>
<li><p>DELETE - Allows deletion of records and collections</p></li>
<li><p>SHARE - Allows setting access controls on records and collections</p></li>
<li><p>LOCK - Allows locking a record or collection to temporarily suppress all permissions</p></li>
</ul>
<p>Multiple user- and group- scoped permission may be applied. Permissions for a given user are evaluated by combining all
permission set for all scopes that apply - including permissions that may be inherited from parent collection hierarchies.
Because permissions are inherited and additive, the absence of a permission on a given data record or collection is not
equivalent to denying that permission.</p>
<p>Access controls are typically applied to parent collections of a collection hierarchy where contained data and sub-collections
inherit the permissions defined by the top-level parent. Collections have both “local” and “inherited” permissions; where
local permissions control access to the collection record itself, and “inherited” permissions are the permissions passed
down to all contained data records and sub-collections. Note that because data records can be placed into multiple collections,
the inherited permissions of <em>all</em> associated parent collections are evaluated for each users accessing a given data record.</p>
</div>
<div class="section" id="repository-allocations">
<h3>Repository Allocations</h3>
<p>Having access to DataFed does not, in itself, grant users the ability to create or manage data within DataFed. This is because
DataFed does not provide any raw data storage on its own, but instead relies on <em>federated</em> storage provided by DataFed member
organization and/or facilities. Federated storage is implemented through a network of geographically distributed “data repositories”
that are owned and maintained by specific member organizations, yet are potentially accessible by any DataFed user.</p>
<p>Typically, DataFed users with an account at one or more DataFed member facilities will be automatically granted storage
allocations on data repositories managed by the organization that operates the facilities. For unaffiliated users, storage
allocations may be explicitly requested from a DataFed member organizations. DataFed member organizations are free to define
and enforce their own data storage policies; therefore, users wishing to acquire storage a specific allocation must contact the
associated organization for information on how to gain access. Even though unaffiliated users with no storage allocation cannot
use DataFed to create and manage their own data, DataFed is still allows these users to locate, access, and monitor data owned
by other DataFed users or projects.</p>
<p>It is likely that DataFed users may have multiple storage allocations on different data repositories. In this case, a default
storage allocation may be specified, or a specific storage allocation selected when creating new DataFed data records. Data can
be accessed in a consistent manner no matter which data repository it is stored on; however, the physical proximity of a data
repository in relation to the point of use of data can impact access latency.</p>
</div>
<div class="section" id="catalog">
<h3>Catalog</h3>
<p>The DataFed catalog allows collections and data records to be is internally published for use by any DataFed user. The catalog
allows users to browse collections through hierarchical categories and to search for collections and datasets directly by
filtering field values.</p>
</div>
<div class="section" id="data-search">
<h3>Data Search</h3>
<p>TBD</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="usecases.html" class="btn btn-neutral float-right" title="Use Cases" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="introduction.html" class="btn btn-neutral float-left" title="Introduction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Oak Ridge National Laboratories

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>
